{"last_node_id":14,"last_link_id":19,"nodes":[{"id":10,"type":"MochiDecode","pos":[1306,158],"size":[315,246],"flags":{},"order":7,"mode":0,"inputs":[{"name":"vae","type":"MOCHIVAE","link":11,"localized_name":"vae"},{"name":"samples","type":"LATENT","link":19,"localized_name":"samples"}],"outputs":[{"name":"images","type":"IMAGE","links":[14],"slot_index":0,"localized_name":"images"}],"properties":{"Node name for S&R":"MochiDecode"},"widgets_values":[true,false,10,160,312,0.25,0.25,false]},{"id":11,"type":"GetImageSizeAndCount","pos":[1385,441],"size":[222.00714111328125,86],"flags":{},"order":8,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":14,"localized_name":"image"}],"outputs":[{"name":"image","type":"IMAGE","links":[15],"slot_index":0,"localized_name":"image"},{"name":"854 width","type":"INT","links":null,"localized_name":"width"},{"name":"480 height","type":"INT","links":null,"localized_name":"height"},{"name":"49 count","type":"INT","links":null,"localized_name":"count"}],"properties":{"Node name for S&R":"GetImageSizeAndCount"},"widgets_values":[]},{"id":12,"type":"Note","pos":[1271,-119],"size":[365.5867919921875,208.3488311767578],"flags":{},"order":0,"mode":0,"inputs":[],"outputs":[],"title":"Note: WIP!","properties":{},"widgets_values":["VAE decoding is extremely heavy so tiling is necessary, I have not found best settings for it yet so testing help is appreciated, you can keep decoding after sampling as the latents are still in memory to see what works.\n\nEither adjust frame_batch_size to decode less frames at once, this tends to cause frame skipping though.\n\nOr use higher batch and smaller tiles to still fit it in memory.\n\n@Kijaidesign"],"color":"#432","bgcolor":"#653"},{"id":9,"type":"VHS_VideoCombine","pos":[1683,63],"size":[1260,1019.3270874023438],"flags":{},"order":9,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":15,"shape":7,"localized_name":"images"},{"name":"audio","type":"AUDIO","link":null,"shape":7,"localized_name":"audio"},{"name":"meta_batch","type":"VHS_BatchManager","link":null,"shape":7,"localized_name":"meta_batch"},{"name":"vae","type":"VAE","link":null,"shape":7,"localized_name":"vae"}],"outputs":[{"name":"Filenames","type":"VHS_FILENAMES","links":null,"localized_name":"Filenames"}],"properties":{"Node name for S&R":"VHS_VideoCombine"},"widgets_values":{"frame_rate":24,"loop_count":0,"filename_prefix":"Mochi_preview","format":"video/h264-mp4","pix_fmt":"yuv420p","crf":19,"save_metadata":true,"pingpong":false,"save_output":true,"videopreview":{"hidden":false,"paused":false,"params":{"filename":"Mochi_preview_00002.mp4","subfolder":"","type":"output","format":"video/h264-mp4","frame_rate":24},"muted":false}}},{"id":13,"type":"Note","pos":[1050,640],"size":[350,230],"flags":{},"order":1,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["https://github.com/kijai/ComfyUI-MochiWrapper\n(ComfyUI\\custom_nodes)\n\nhttps://huggingface.co/Kijai/Mochi_preview_comfy/blob/main/mochi_preview_dit_fp8_e4m3fn.safetensors\n(ComfyUI\\models\\diffusion_models\\mochi)\n\nhttps://huggingface.co/Kijai/Mochi_preview_comfy/blob/main/mochi_preview_vae_bf16.safetensors\n(ComfyUI\\models\\vae\\mochi)\n\nhttps://huggingface.co/stabilityai/stable-diffusion-3.5-large/blob/main/text_encoders/t5xxl_fp8_e4m3fn.safetensors\n(ComfyUI\\models\\clip\\sd3)\n\n@Datou"],"color":"#223","bgcolor":"#335"},{"id":2,"type":"CLIPLoader","pos":[70,420],"size":[350,82],"flags":{},"order":2,"mode":0,"inputs":[],"outputs":[{"name":"CLIP","type":"CLIP","links":[1,8],"localized_name":"CLIP"}],"properties":{"Node name for S&R":"CLIPLoader"},"widgets_values":["t5\\google_t5-v1_1-xxl_encoderonly-fp8_e4m3fn.safetensors","sd3","default"]},{"id":4,"type":"DownloadAndLoadMochiModel","pos":[472.9477233886719,-16.418716430664062],"size":[400,198],"flags":{},"order":3,"mode":0,"inputs":[{"name":"trigger","type":"CONDITIONING","link":null,"shape":7,"localized_name":"trigger"},{"name":"compile_args","type":"MOCHICOMPILEARGS","link":null,"shape":7,"localized_name":"compile_args"}],"outputs":[{"name":"mochi_model","type":"MOCHIMODEL","links":[16],"slot_index":0,"localized_name":"mochi_model"},{"name":"mochi_vae","type":"MOCHIVAE","links":[11],"slot_index":1,"localized_name":"mochi_vae"}],"properties":{"Node name for S&R":"DownloadAndLoadMochiModel"},"widgets_values":["mochi_preview_dit_fp8_e4m3fn.safetensors","mochi_preview_vae_decoder_bf16.safetensors","fp8_e4m3fn","sdpa",false,"default"]},{"id":8,"type":"MochiTextEncode","pos":[480,580],"size":[400,200],"flags":{},"order":5,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":8,"localized_name":"clip"}],"outputs":[{"name":"conditioning","type":"CONDITIONING","links":[18],"slot_index":0,"localized_name":"conditioning"},{"name":"clip","type":"CLIP","links":null,"localized_name":"clip"}],"properties":{"Node name for S&R":"MochiTextEncode"},"widgets_values":["text",1,true],"color":"#322","bgcolor":"#533"},{"id":14,"type":"MochiSampler","pos":[976.87939453125,190.359130859375],"size":[315,326],"flags":{},"order":6,"mode":0,"inputs":[{"name":"model","type":"MOCHIMODEL","link":16,"localized_name":"model"},{"name":"positive","type":"CONDITIONING","link":17,"localized_name":"positive"},{"name":"negative","type":"CONDITIONING","link":18,"localized_name":"negative"},{"name":"opt_sigmas","type":"SIGMAS","link":null,"shape":7,"localized_name":"opt_sigmas"},{"name":"samples","type":"LATENT","link":null,"shape":7,"localized_name":"samples"},{"name":"fastercache","type":"FASTERCACHEARGS","link":null,"shape":7,"localized_name":"fastercache"},{"name":"cfg_schedule","type":"FLOAT","link":null,"widget":{"name":"cfg_schedule"},"shape":7}],"outputs":[{"name":"samples","type":"LATENT","links":[19],"slot_index":0,"localized_name":"samples"}],"properties":{"Node name for S&R":"MochiSampler"},"widgets_values":[848,480,49,50,4.5,482501639655994,"randomize",0]},{"id":1,"type":"MochiTextEncode","pos":[480,260],"size":[400,260],"flags":{},"order":4,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":1,"localized_name":"clip"}],"outputs":[{"name":"conditioning","type":"CONDITIONING","links":[17],"slot_index":0,"localized_name":"conditioning"},{"name":"clip","type":"CLIP","links":null,"localized_name":"clip"}],"properties":{"Node name for S&R":"MochiTextEncode"},"widgets_values":["Real photograph of a black cat playing an electric guitar, the cat looks like a rocker, it is on a rock concert stage",1,true],"color":"#232","bgcolor":"#353"}],"links":[[1,2,0,1,0,"CLIP"],[8,2,0,8,0,"CLIP"],[11,4,1,10,0,"MOCHIVAE"],[14,10,0,11,0,"IMAGE"],[15,11,0,9,0,"IMAGE"],[16,4,0,14,0,"MOCHIMODEL"],[17,1,0,14,1,"CONDITIONING"],[18,8,0,14,2,"CONDITIONING"],[19,14,0,10,1,"LATENT"]],"groups":[],"config":{},"extra":{"ds":{"scale":1.6105100000000008,"offset":[-35.147103702711036,31.87719618884705]}},"version":0.4}